import { getLocales } from 'expo-localization';

export type Language = 'en' | 'ko';

export const detectLanguage = (): Language => {
  const deviceLocale = getLocales()[0]?.languageTag?.toLowerCase();
  const intlLocale = Intl.DateTimeFormat().resolvedOptions().locale?.toLowerCase();
  const locale = deviceLocale ?? intlLocale ?? 'en';
  return locale.startsWith('ko') ? 'ko' : 'en';
};

export const translations = {
  en: {
    tabs_capture: 'Capture',
    tabs_compare: 'Compare',
    tabs_history: 'History',
    tabs_profile: 'Profile',
    init_preparing: 'Preparing Japan Price Tracker',
    init_subtitle: 'Initializing your local database',
    init_failed: 'Initialization failed',
    retry: 'Retry',
    back: 'Back',
    reset: 'Reset',

    capture_title: 'Quick Price Capture',
    capture_subtitle: 'Track merchandise prices while moving across stores in Japan.',
    capture_header_new_price: 'New Price',
    capture_header_new_entry: 'New Entry',
    capture_details: 'Details',
    name: 'Name',
    merchandise: 'Merchandise',
    capture_product_placeholder: 'Enter product name',
    capture_price_placeholder: '0',
    capture_store_placeholder: 'Store name',
    price_jpy: 'Price (JPY)',
    price: 'Price',
    category: 'Category',
    date: 'Date',
    store: 'Store',
    store_name: 'Store Name',
    system_store_name: 'System Store Name',
    store_nickname_optional: 'Store Nickname (Optional)',
    location: 'Location',
    recent_stores: 'Recent Stores',
    saved_store_search_placeholder: 'Search saved stores',
    add_new_place: 'Add New Place',
    select_store_first_hint: 'Select a store/place first to continue entry.',
    store_nickname_placeholder: 'Set your own label for this store',
    loading_recent_stores: 'Loading recent stores...',
    no_recent_stores: 'No saved stores yet. Add a new place first.',
    pick_on_map: 'Pick on Map',
    change_on_map: 'Change on Map',
    view_map: 'View Map',
    change: 'Change',
    place: 'Place',
    city_area: 'City Area',
    not_selected: 'Not selected',
    unnamed_place: 'Unnamed place',
    notes: 'Notes',
    capture_notes_placeholder: 'Add details about shelf location or specific discount conditions...',
    capture_share_hint: 'Prices are shared anonymously with the community.',
    capture_detected_hint: 'Product detected from barcode scan.',
    location_required_hint: 'Select the store location on map before saving this price.',
    observed_at: 'Observed Date',
    preview: 'Preview',
    save_entry: 'Save Entry',
    saving: 'Saving...',
    saved_title: 'Saved',
    saved_message: 'Price entry recorded locally on your device.',
    saved_status: 'Saved. Capture the next store price while walking.',
    map_selected_status: 'Location selected from map. You can still edit fields before saving.',
    map_required_status: 'Please pick store location from map before saving.',
    input_error: 'Please check your input values.',
    save_error: 'Failed to save entry.',
    validation_product_required: 'Enter a product name.',
    validation_price_required: 'Enter a price.',
    validation_price_invalid_integer: 'Price must be a whole number.',
    validation_price_positive: 'Price must be greater than 0.',
    validation_system_store_required: 'Select a place to set the store name.',
    validation_store_required: 'Enter a store name.',
    validation_city_area_required: 'Select a city area from map.',
    validation_date_required: 'Select an observed date.',
    validation_location_required: 'Select the store location on map before saving this price.',
    validation_address_required: 'Select a place with a valid address.',
    validation_coordinates_invalid: 'Selected map coordinates are invalid.',
    clear_nickname_title: 'Remove nickname?',
    clear_nickname_body: 'This store already has a nickname. Save without nickname and remove it?',
    clear_nickname_confirm: 'Remove',

    compare_title: 'Where Should You Buy?',
    compare_subtitle: 'Compare item prices by area, then revisit the best store based on price and distance.',
    compare_header_title: 'Compare',
    compare_best_value: 'BEST VALUE',
    compare_loading: 'Loading latest rankings...',
    compare_empty_title: 'No comparisons yet',
    compare_empty_body: 'Capture at least one product across multiple stores to see rankings.',
    compare_distance_unavailable: 'Distance unavailable',
    compare_navigate: 'Navigate',
    compare_nav_pending: 'Navigation handoff is not connected yet in this build.',
    navigation_open_failed: 'Could not open a map app for directions. Please check app availability.',
    compare_price_history: 'Price History',
    compare_see_all: 'See All',
    compare_price_comparison: 'Price Comparison',
    compare_view_full_history: 'View Full History',
    compare_top_recommendations: 'Top Recommendations',
    compare_vs_avg: 'vs Avg',
    compare_last_verified: 'Last verified {{time}}',
    compare_open_24h: 'Open 24h',
    compare_save_prefix: 'Save',
    compare_regular: 'Regular',
    compare_saved: 'Store saved to quick access.',
    compare_unsaved: 'Store removed from quick access.',
    distance_context: 'Distance Context',
    update_location: 'Update Location',
    locating: 'Locating...',
    location_default: 'Distance uses your current location when available.',
    location_using: 'Using your location near {{area}}. Distances update automatically for recommendations.',
    merchandise_section: 'Merchandise',
    city_area_section: 'City Area',
    all_areas: 'All Areas',
    no_item_selected: 'No item selected',
    no_item_selected_body: 'Add at least one price entry in Capture to begin comparisons.',
    best_store_now: 'Best Store Now',
    best_store_meta: '{{product}} · {{price}} · {{area}}',
    no_comparisons: 'No comparisons yet',
    no_comparisons_body: 'Try another city area or capture this item at multiple stores to unlock ranking.',
    compare_load_error: 'Failed to load comparisons.',
    detail_title: 'Entry Details',
    detail_share: 'Share',
    detail_share_pending: 'Share action is not connected yet in this build.',
    detail_missing_params_title: 'Entry details unavailable',
    detail_missing_params_body: 'Return to Compare and open a valid price tile.',
    detail_badge_great: 'Great Deal',
    detail_badge_standard: 'Recorded Price',
    detail_information_heading: 'Information',
    detail_location_heading: 'Location',
    detail_store_label: 'Store',
    detail_area_label: 'Area',
    detail_observed_label: 'Observed',
    detail_coordinates: 'Lat {{latitude}}, Lng {{longitude}}',
    detail_navigate: 'Navigate',
    detail_navigate_pending: 'Navigation handoff is not connected yet in this build.',
    detail_notes_empty: 'No notes added for this entry.',
    detail_meta_empty: 'No contributor metadata available.',
    detail_edit_entry: 'Edit Entry',
    detail_delete_entry: 'Delete Entry',
    detail_edit_pending: 'Edit flow will be connected in a future update.',
    detail_delete_pending: 'Delete flow will be connected in a future update.',

    history_title: 'Price History',
    history_subtitle: 'Audit recent captures and confirm confidence before purchase.',
    history_filter: 'Filter',
    history_timeline_count: 'Timeline • {{count}} entries',
    history_last_30_days: 'Last 30 days',
    history_no_more: 'No more history available',
    product_filter: 'Product Filter',
    store_filter: 'Store Filter',
    all_products: 'All Products',
    all_stores: 'All Stores',
    entries_count: '{{count}} entries',
    entries_for: ' for {{name}}',
    no_history: 'No matching history',
    no_history_body: 'Try changing filters or capture new store prices.',
    observed_prefix: 'Observed {{date}}',

    chart_latest_price: 'Latest Price by Store',
    map_title: 'Store Map',
    map_distance_km: '{{distance}} km away',
    selected_place: 'Selected place',
    no_address: 'No address details available',
    cancel: 'Cancel',
    confirm: 'Confirm',
    confirm_location: 'Confirm Location',
    pick_place: 'Pick Place',
    search_placeholder: 'Search store or landmark in Japan',
    search_placeholder_short: 'Search',
    search_disabled_placeholder: 'Search disabled, use pin selection',
    search_hint: 'Search store or landmark, then fine-tune pin.',
    search_missing_key: 'Search unavailable (missing Google Places key). Move pin to select location.',
    search_quota: 'Search quota reached. Move pin to select location.',
    search_denied: 'Search denied by Google API key settings. Use pin selection or fix key restrictions/billing.',
    search_unavailable: 'Search unavailable right now. Move pin to select location.',
    searching_places: 'Searching places...',
    applying: 'Applying...',
    map_centering: 'Centering map on your current location...',
    resolving_address: 'Resolving address...',
    done: 'Done',

    tag_best: 'BEST',
    tag_cheapest: 'CHEAPEST',
    tag_closest: 'CLOSEST',
    score_label: 'Score {{score}}',

    profile_title: 'Profile',
    profile_placeholder_title: 'Personalization is coming soon',
    profile_placeholder_body: 'Saved stores, shopping preferences, and account settings will appear here.'
  },
  ko: {
    tabs_capture: '기록',
    tabs_compare: '비교',
    tabs_history: '이력',
    tabs_profile: '프로필',
    init_preparing: '일본 가격 추적기 준비 중',
    init_subtitle: '로컬 데이터베이스를 초기화하고 있어요',
    init_failed: '초기화에 실패했어요',
    retry: '다시 시도',
    back: '뒤로',
    reset: '초기화',

    capture_title: '빠른 가격 기록',
    capture_subtitle: '일본의 여러 매장을 이동하면서 상품 가격을 기록하세요.',
    capture_header_new_price: '새 가격',
    capture_header_new_entry: '새 항목',
    capture_details: '세부정보',
    name: '이름',
    merchandise: '상품명',
    capture_product_placeholder: '상품명을 입력하세요',
    capture_price_placeholder: '0',
    capture_store_placeholder: '매장 이름',
    price_jpy: '가격 (JPY)',
    price: '가격',
    category: '카테고리',
    date: '날짜',
    store: '매장',
    store_name: '매장 이름',
    system_store_name: '시스템 매장 이름',
    store_nickname_optional: '매장 별칭 (선택)',
    location: '위치',
    recent_stores: '최근 매장',
    saved_store_search_placeholder: '저장된 매장 검색',
    add_new_place: '새 장소 추가',
    select_store_first_hint: '입력을 계속하려면 먼저 매장/장소를 선택해 주세요.',
    store_nickname_placeholder: '이 매장에 사용할 별칭을 입력하세요',
    loading_recent_stores: '최근 매장을 불러오는 중...',
    no_recent_stores: '저장된 매장이 아직 없어요. 먼저 새 장소를 추가해 주세요.',
    pick_on_map: '지도에서 선택',
    change_on_map: '지도에서 변경',
    view_map: '지도 보기',
    change: '변경',
    place: '장소',
    city_area: '지역',
    not_selected: '선택 안 됨',
    unnamed_place: '이름 없는 장소',
    notes: '메모',
    capture_notes_placeholder: '진열 위치나 할인 조건 등의 메모를 남겨보세요...',
    capture_share_hint: '가격 데이터는 익명으로 커뮤니티와 공유됩니다.',
    capture_detected_hint: '바코드 스캔으로 상품을 인식했어요.',
    location_required_hint: '가격 저장 전에 지도에서 매장 위치를 선택해 주세요.',
    observed_at: '관찰 날짜',
    preview: '미리보기',
    save_entry: '저장',
    saving: '저장 중...',
    saved_title: '저장 완료',
    saved_message: '가격 기록이 기기에 로컬로 저장되었어요.',
    saved_status: '저장되었습니다. 다음 매장 가격을 계속 기록해 보세요.',
    map_selected_status: '지도에서 위치를 선택했어요. 저장 전까지 수정할 수 있어요.',
    map_required_status: '저장 전에 지도에서 매장 위치를 선택해 주세요.',
    input_error: '입력값을 확인해 주세요.',
    save_error: '저장에 실패했어요.',
    validation_product_required: '상품명을 입력해 주세요.',
    validation_price_required: '가격을 입력해 주세요.',
    validation_price_invalid_integer: '가격은 정수로 입력해 주세요.',
    validation_price_positive: '가격은 0보다 커야 해요.',
    validation_system_store_required: '장소를 선택해 매장 이름을 설정해 주세요.',
    validation_store_required: '매장 이름을 입력해 주세요.',
    validation_city_area_required: '지도에서 지역을 선택해 주세요.',
    validation_date_required: '관찰 날짜를 선택해 주세요.',
    validation_location_required: '가격 저장 전에 지도에서 매장 위치를 선택해 주세요.',
    validation_address_required: '유효한 주소가 있는 장소를 선택해 주세요.',
    validation_coordinates_invalid: '선택한 지도 좌표가 올바르지 않아요.',
    clear_nickname_title: '별칭을 삭제할까요?',
    clear_nickname_body: '이 매장에는 기존 별칭이 있어요. 별칭 없이 저장하고 삭제할까요?',
    clear_nickname_confirm: '삭제',

    compare_title: '어디서 구매할까요?',
    compare_subtitle: '지역별 가격을 비교하고, 가격과 거리 기준으로 최적 매장을 확인하세요.',
    compare_header_title: '비교',
    compare_best_value: '최적 가치',
    compare_loading: '최신 비교를 불러오는 중...',
    compare_empty_title: '비교 데이터가 없어요',
    compare_empty_body: '여러 매장의 같은 상품 가격을 먼저 기록하면 비교가 표시돼요.',
    compare_distance_unavailable: '거리 정보 없음',
    compare_navigate: '길찾기',
    compare_nav_pending: '이 빌드에서는 외부 길찾기 연동이 준비 중이에요.',
    navigation_open_failed: '길찾기 앱을 열 수 없어요. 지도 앱 설치 상태를 확인해 주세요.',
    compare_price_history: '가격 이력',
    compare_see_all: '전체 보기',
    compare_price_comparison: '가격 비교',
    compare_view_full_history: '전체 이력 보기',
    compare_top_recommendations: '추천 매장',
    compare_vs_avg: '평균 대비',
    compare_last_verified: '최근 확인 {{time}}',
    compare_open_24h: '24시간 영업',
    compare_save_prefix: '절약',
    compare_regular: '보통',
    compare_saved: '즐겨찾기에 저장했어요.',
    compare_unsaved: '즐겨찾기에서 제거했어요.',
    distance_context: '거리 정보',
    update_location: '내 위치 갱신',
    locating: '위치 확인 중...',
    location_default: '가능하면 현재 위치를 기준으로 거리를 계산해요.',
    location_using: '{{area}} 주변 위치를 사용 중이에요. 추천 거리가 자동으로 업데이트돼요.',
    merchandise_section: '상품',
    city_area_section: '지역',
    all_areas: '전체 지역',
    no_item_selected: '선택된 상품이 없어요',
    no_item_selected_body: '비교를 시작하려면 먼저 기록 탭에서 가격을 입력해 주세요.',
    best_store_now: '지금 가장 좋은 매장',
    best_store_meta: '{{product}} · {{price}} · {{area}}',
    no_comparisons: '비교할 데이터가 없어요',
    no_comparisons_body: '다른 지역을 선택하거나 여러 매장의 가격을 더 기록해 보세요.',
    compare_load_error: '비교 데이터를 불러오지 못했어요.',
    detail_title: '항목 상세',
    detail_share: '공유',
    detail_share_pending: '이 빌드에서는 공유 기능이 아직 연결되지 않았어요.',
    detail_missing_params_title: '항목 상세를 표시할 수 없어요',
    detail_missing_params_body: '비교 화면으로 돌아가 유효한 가격 타일을 다시 열어 주세요.',
    detail_badge_great: '좋은 가격',
    detail_badge_standard: '기록된 가격',
    detail_information_heading: '정보',
    detail_location_heading: '위치',
    detail_store_label: '매장',
    detail_area_label: '지역',
    detail_observed_label: '관찰일',
    detail_coordinates: '위도 {{latitude}}, 경도 {{longitude}}',
    detail_navigate: '길찾기',
    detail_navigate_pending: '이 빌드에서는 외부 길찾기 연동이 준비 중이에요.',
    detail_notes_empty: '이 항목에 추가된 메모가 없어요.',
    detail_meta_empty: '작성자/검증 메타데이터가 없어요.',
    detail_edit_entry: '항목 수정',
    detail_delete_entry: '항목 삭제',
    detail_edit_pending: '수정 플로우는 다음 업데이트에서 연결될 예정이에요.',
    detail_delete_pending: '삭제 플로우는 다음 업데이트에서 연결될 예정이에요.',

    history_title: '가격 이력',
    history_subtitle: '최근 기록을 확인해 구매 결정을 더 확실하게 하세요.',
    history_filter: '필터',
    history_timeline_count: '타임라인 • {{count}}개 항목',
    history_last_30_days: '최근 30일',
    history_no_more: '더 이상 표시할 기록이 없어요',
    product_filter: '상품 필터',
    store_filter: '매장 필터',
    all_products: '전체 상품',
    all_stores: '전체 매장',
    entries_count: '{{count}}개 기록',
    entries_for: ' · {{name}}',
    no_history: '조건에 맞는 이력이 없어요',
    no_history_body: '필터를 바꾸거나 새 가격을 기록해 보세요.',
    observed_prefix: '관찰일 {{date}}',

    chart_latest_price: '매장별 최신 가격',
    map_title: '매장 지도',
    map_distance_km: '{{distance}}km 거리',
    selected_place: '선택된 장소',
    no_address: '주소 정보가 없어요',
    cancel: '취소',
    confirm: '확인',
    confirm_location: '위치 확정',
    pick_place: '장소 선택',
    search_placeholder: '일본 내 매장/랜드마크 검색',
    search_placeholder_short: '검색',
    search_disabled_placeholder: '검색 비활성화, 핀으로 선택하세요',
    search_hint: '장소를 검색한 뒤 핀 위치를 세밀하게 조정하세요.',
    search_missing_key: 'Google Places 키가 없어 검색할 수 없어요. 핀으로 위치를 선택하세요.',
    search_quota: '검색 할당량이 초과되었어요. 핀으로 위치를 선택하세요.',
    search_denied: 'Google API 키 설정으로 검색이 거부되었어요. 핀 선택을 사용하거나 키 설정/결제를 확인하세요.',
    search_unavailable: '검색을 지금 사용할 수 없어요. 핀으로 위치를 선택하세요.',
    searching_places: '장소 검색 중...',
    applying: '적용 중...',
    map_centering: '현재 위치로 지도를 맞추는 중...',
    resolving_address: '주소를 확인하는 중...',
    done: '완료',

    tag_best: '최적',
    tag_cheapest: '최저가',
    tag_closest: '최단거리',
    score_label: '점수 {{score}}',

    profile_title: '프로필',
    profile_placeholder_title: '개인화 기능 준비 중',
    profile_placeholder_body: '저장한 매장, 쇼핑 선호도, 계정 설정이 여기에 표시될 예정입니다.'
  }
} as const;

export type TranslationKey = keyof typeof translations.en;
